var w=Object.defineProperty;var v=(e,r,t)=>r in e?w(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var c=(e,r,t)=>v(e,typeof r!="symbol"?r+"":r,t);var p=(e,r,t={})=>{let i=`${e}=${r}`;if(e.startsWith("__Secure-")&&!t.secure)throw new Error("__Secure- Cookie must have Secure attributes");if(e.startsWith("__Host-")){if(!t.secure)throw new Error("__Host- Cookie must have Secure attributes");if(t.path!=="/")throw new Error('__Host- Cookie must have Path attributes with "/"');if(t.domain)throw new Error("__Host- Cookie must not have Domain attributes")}if(t&&typeof t.maxAge=="number"&&t.maxAge>=0){if(t.maxAge>3456e4)throw new Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");i+=`; Max-Age=${Math.floor(t.maxAge)}`}if(t.domain&&t.prefix!=="host"&&(i+=`; Domain=${t.domain}`),t.path&&(i+=`; Path=${t.path}`),t.expires){if(t.expires.getTime()-Date.now()>3456e7)throw new Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");i+=`; Expires=${t.expires.toUTCString()}`}if(t.httpOnly&&(i+="; HttpOnly"),t.secure&&(i+="; Secure"),t.sameSite&&(i+=`; SameSite=${t.sameSite.charAt(0).toUpperCase()+t.sameSite.slice(1)}`),t.partitioned){if(!t.secure)throw new Error("Partitioned Cookie must have Secure attributes");i+="; Partitioned"}return i},x=(e,r,t)=>(r=encodeURIComponent(r),p(e,r,t)),P=(e,r)=>(e=e.replace(/\/+$/,""),e=e+"/",r=r.replace(/^\/+/,""),e+r),m=(e,r)=>{for(const[t,i]of Object.entries(r)){const n=new RegExp("/:"+t+"(?:{[^/]+})?");e=e.replace(n,`/${i}`)}return e},C=(e,r)=>{switch(r){case"ws":return e.replace(/^http/,"ws");case"http":return e.replace(/^ws/,"http")}},k=e=>/^https?:\/\/[^\/]+?\/index$/.test(e)?e.replace(/\/index$/,"/"):e.replace(/\/index$/,"");function f(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function d(e,r){if(!f(e)&&!f(r))return r;const t={...e};for(const i in r){const n=r[i];f(t[i])&&f(n)?t[i]=d(t[i],n):t[i]=n}return t}var l=(e,r)=>new Proxy(()=>{},{get(i,n){if(!(typeof n!="string"||n==="then"))return l(e,[...r,n])},apply(i,n,a){return e({path:r,args:a})}}),S=class{constructor(e,r){c(this,"url");c(this,"method");c(this,"queryParams");c(this,"pathParams",{});c(this,"rBody");c(this,"cType");c(this,"fetch",async(e,r)=>{if(e){if(e.query){for(const[s,h]of Object.entries(e.query))if(h!==void 0)if(this.queryParams||(this.queryParams=new URLSearchParams),Array.isArray(h))for(const o of h)this.queryParams.append(s,o);else this.queryParams.set(s,h)}if(e.form){const s=new FormData;for(const[h,o]of Object.entries(e.form))if(Array.isArray(o))for(const y of o)s.append(h,y);else s.append(h,o);this.rBody=s}e.json&&(this.rBody=JSON.stringify(e.json),this.cType="application/json"),e.param&&(this.pathParams=e.param)}let t=this.method.toUpperCase();const i={...(e==null?void 0:e.header)??{},...typeof(r==null?void 0:r.headers)=="function"?await r.headers():r!=null&&r.headers?r.headers:{}};if(e!=null&&e.cookie){const s=[];for(const[h,o]of Object.entries(e.cookie))s.push(x(h,o,{path:"/"}));i.Cookie=s.join(",")}this.cType&&(i["Content-Type"]=this.cType);const n=new Headers(i??void 0);let a=this.url;a=k(a),a=m(a,this.pathParams),this.queryParams&&(a=a+"?"+this.queryParams.toString()),t=this.method.toUpperCase();const u=!(t==="GET"||t==="HEAD");return((r==null?void 0:r.fetch)||fetch)(a,{body:u?this.rBody:void 0,method:t,headers:n,...r==null?void 0:r.init})});this.url=e,this.method=r}},_=(e,r)=>l(function t(i){const n=[...i.path];if(n[n.length-1]==="toString")return n[n.length-2]==="name"?n[n.length-3]||"":t.toString();if(n[n.length-1]==="valueOf")return n[n.length-2]==="name"?n[n.length-3]||"":t;let a="";if(/^\$/.test(n[n.length-1])){const o=n.pop();o&&(a=o.replace(/^\$/,""))}const u=n.join("/"),s=P(e,u);if(a==="url")return i.args[0]&&i.args[0].param?new URL(m(s,i.args[0].param)):new URL(s);if(a==="ws"){const o=C(i.args[0]&&i.args[0].param?m(s,i.args[0].param):s,"ws");return new WebSocket(o)}const h=new S(s,a);if(a){r??(r={});const o=d(r,{...i.args[1]??{}});return h.fetch(i.args[0],o)}return h},[]);const g=_("http://localhost:8000/"),U=g.api;export{U as a};
