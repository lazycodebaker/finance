var at=s=>{throw TypeError(s)};var H=(s,t,e)=>t.has(s)||at("Cannot "+e);var i=(s,t,e)=>(H(s,t,"read from private field"),e?e.call(s):t.get(s)),p=(s,t,e)=>t.has(s)?at("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e),c=(s,t,e,r)=>(H(s,t,"write to private field"),r?r.call(s,e):t.set(s,e),e),d=(s,t,e)=>(H(s,t,"access private method"),e);import{S as vt,r as C,s as K,a as k,n as yt,i as ot,b as ht,t as Rt,f as mt,d as Ct,e as ut,g as ft,h as O,u as Ot,c as St,j as U,k as Et}from"./index-Ik2I8vuS.js";import{a as xt}from"./client-CKigFS6i.js";var b,n,_,g,Q,D,m,A,L,P,w,F,x,T,a,M,J,$,G,X,Y,Z,q,pt,dt,It=(dt=class extends vt{constructor(t,e){super();p(this,a);p(this,b);p(this,n);p(this,_);p(this,g);p(this,Q);p(this,D);p(this,m);p(this,A);p(this,L);p(this,P);p(this,w);p(this,F);p(this,x);p(this,T,new Set);this.options=e,c(this,b,t),c(this,m,null),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,n).addObserver(this),ct(i(this,n),this.options)?d(this,a,M).call(this):this.updateResult(),d(this,a,X).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return tt(i(this,n),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return tt(i(this,n),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,d(this,a,Y).call(this),d(this,a,Z).call(this),i(this,n).removeObserver(this)}setOptions(t,e){const r=this.options,l=i(this,n);if(this.options=i(this,b).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof C(this.options.enabled,i(this,n))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");d(this,a,q).call(this),i(this,n).setOptions(this.options),r._defaulted&&!K(this.options,r)&&i(this,b).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,n),observer:this});const u=this.hasListeners();u&&lt(i(this,n),l,this.options,r)&&d(this,a,M).call(this),this.updateResult(e),u&&(i(this,n)!==l||C(this.options.enabled,i(this,n))!==C(r.enabled,i(this,n))||k(this.options.staleTime,i(this,n))!==k(r.staleTime,i(this,n)))&&d(this,a,J).call(this);const o=d(this,a,$).call(this);u&&(i(this,n)!==l||C(this.options.enabled,i(this,n))!==C(r.enabled,i(this,n))||o!==i(this,x))&&d(this,a,G).call(this,o)}getOptimisticResult(t){const e=i(this,b).getQueryCache().build(i(this,b),t),r=this.createResult(e,t);return wt(this,r)&&(c(this,g,r),c(this,D,this.options),c(this,Q,i(this,n).state)),r}getCurrentResult(){return i(this,g)}trackResult(t,e){const r={};return Object.keys(t).forEach(l=>{Object.defineProperty(r,l,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(l),e==null||e(l),t[l])})}),r}trackProp(t){i(this,T).add(t)}getCurrentQuery(){return i(this,n)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=i(this,b).defaultQueryOptions(t),r=i(this,b).getQueryCache().build(i(this,b),e);return r.isFetchingOptimistic=!0,r.fetch().then(()=>this.createResult(r,e))}fetch(t){return d(this,a,M).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,g)))}createResult(t,e){var nt;const r=i(this,n),l=this.options,u=i(this,g),o=i(this,Q),f=i(this,D),S=t!==r?t.state:i(this,_),{state:E}=t;let h={...E},j=!1,v;if(e._optimisticResults){const y=this.hasListeners(),V=!y&&ct(t,e),bt=y&&lt(t,r,e,l);(V||bt)&&(h={...h,...Ct(E.data,t.options)}),e._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:B,errorUpdatedAt:st,status:I}=h;if(e.select&&h.data!==void 0)if(u&&h.data===(o==null?void 0:o.data)&&e.select===i(this,A))v=i(this,L);else try{c(this,A,e.select),v=e.select(h.data),v=ut(u==null?void 0:u.data,v,e),c(this,L,v),c(this,m,null)}catch(y){c(this,m,y)}else v=h.data;if(e.placeholderData!==void 0&&v===void 0&&I==="pending"){let y;if(u!=null&&u.isPlaceholderData&&e.placeholderData===(f==null?void 0:f.placeholderData))y=u.data;else if(y=typeof e.placeholderData=="function"?e.placeholderData((nt=i(this,P))==null?void 0:nt.state.data,i(this,P)):e.placeholderData,e.select&&y!==void 0)try{y=e.select(y),c(this,m,null)}catch(V){c(this,m,V)}y!==void 0&&(I="success",v=ut(u==null?void 0:u.data,y,e),j=!0)}i(this,m)&&(B=i(this,m),v=i(this,L),st=Date.now(),I="error");const N=h.fetchStatus==="fetching",W=I==="pending",z=I==="error",it=W&&N,rt=v!==void 0;return{status:I,fetchStatus:h.fetchStatus,isPending:W,isSuccess:I==="success",isError:z,isInitialLoading:it,isLoading:it,data:v,dataUpdatedAt:h.dataUpdatedAt,error:B,errorUpdatedAt:st,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>S.dataUpdateCount||h.errorUpdateCount>S.errorUpdateCount,isFetching:N,isRefetching:N&&!W,isLoadingError:z&&!rt,isPaused:h.fetchStatus==="paused",isPlaceholderData:j,isRefetchError:z&&rt,isStale:et(t,e),refetch:this.refetch}}updateResult(t){const e=i(this,g),r=this.createResult(i(this,n),this.options);if(c(this,Q,i(this,n).state),c(this,D,this.options),i(this,Q).data!==void 0&&c(this,P,i(this,n)),K(r,e))return;c(this,g,r);const l={},u=()=>{if(!e)return!0;const{notifyOnChangeProps:o}=this.options,f=typeof o=="function"?o():o;if(f==="all"||!f&&!i(this,T).size)return!0;const R=new Set(f??i(this,T));return this.options.throwOnError&&R.add("error"),Object.keys(i(this,g)).some(S=>{const E=S;return i(this,g)[E]!==e[E]&&R.has(E)})};(t==null?void 0:t.listeners)!==!1&&u()&&(l.listeners=!0),d(this,a,pt).call(this,{...l,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&d(this,a,X).call(this)}},b=new WeakMap,n=new WeakMap,_=new WeakMap,g=new WeakMap,Q=new WeakMap,D=new WeakMap,m=new WeakMap,A=new WeakMap,L=new WeakMap,P=new WeakMap,w=new WeakMap,F=new WeakMap,x=new WeakMap,T=new WeakMap,a=new WeakSet,M=function(t){d(this,a,q).call(this);let e=i(this,n).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(yt)),e},J=function(){d(this,a,Y).call(this);const t=k(this.options.staleTime,i(this,n));if(ot||i(this,g).isStale||!ht(t))return;const r=Rt(i(this,g).dataUpdatedAt,t)+1;c(this,w,setTimeout(()=>{i(this,g).isStale||this.updateResult()},r))},$=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,n)):this.options.refetchInterval)??!1},G=function(t){d(this,a,Z).call(this),c(this,x,t),!(ot||C(this.options.enabled,i(this,n))===!1||!ht(i(this,x))||i(this,x)===0)&&c(this,F,setInterval(()=>{(this.options.refetchIntervalInBackground||mt.isFocused())&&d(this,a,M).call(this)},i(this,x)))},X=function(){d(this,a,J).call(this),d(this,a,G).call(this,d(this,a,$).call(this))},Y=function(){i(this,w)&&(clearTimeout(i(this,w)),c(this,w,void 0))},Z=function(){i(this,F)&&(clearInterval(i(this,F)),c(this,F,void 0))},q=function(){const t=i(this,b).getQueryCache().build(i(this,b),this.options);if(t===i(this,n))return;const e=i(this,n);c(this,n,t),c(this,_,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},pt=function(t){ft.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(i(this,g))}),i(this,b).getQueryCache().notify({query:i(this,n),type:"observerResultsUpdated"})})},dt);function Qt(s,t){return C(t.enabled,s)!==!1&&s.state.data===void 0&&!(s.state.status==="error"&&t.retryOnMount===!1)}function ct(s,t){return Qt(s,t)||s.state.data!==void 0&&tt(s,t,t.refetchOnMount)}function tt(s,t,e){if(C(t.enabled,s)!==!1){const r=typeof e=="function"?e(s):e;return r==="always"||r!==!1&&et(s,t)}return!1}function lt(s,t,e,r){return(s!==t||C(r.enabled,s)===!1)&&(!e.suspense||s.state.status!=="error")&&et(s,e)}function et(s,t){return C(t.enabled,s)!==!1&&s.isStaleByTime(k(t.staleTime,s))}function wt(s,t){return!K(s.getCurrentResult(),t)}var gt=O.createContext(!1),Ft=()=>O.useContext(gt);gt.Provider;function Ut(){let s=!1;return{clearReset:()=>{s=!1},reset:()=>{s=!0},isReset:()=>s}}var Dt=O.createContext(Ut()),Lt=()=>O.useContext(Dt);function Pt(s,t){return typeof s=="function"?s(...t):!!s}var Tt=(s,t)=>{(s.suspense||s.throwOnError)&&(t.isReset()||(s.retryOnMount=!1))},jt=s=>{O.useEffect(()=>{s.clearReset()},[s])},Mt=({result:s,errorResetBoundary:t,throwOnError:e,query:r})=>s.isError&&!t.isReset()&&!s.isFetching&&r&&Pt(e,[s.error,r]),_t=s=>{s.suspense&&typeof s.staleTime!="number"&&(s.staleTime=1e3)},At=(s,t)=>(s==null?void 0:s.suspense)&&t.isPending,Bt=(s,t,e)=>t.fetchOptimistic(s).catch(()=>{e.clearReset()});function kt(s,t,e){var S,E,h,j;const r=Ot(),l=Ft(),u=Lt(),o=r.defaultQueryOptions(s);(E=(S=r.getDefaultOptions().queries)==null?void 0:S._experimental_beforeQuery)==null||E.call(S,o),o._optimisticResults=l?"isRestoring":"optimistic",_t(o),Tt(o,u),jt(u);const[f]=O.useState(()=>new t(r,o)),R=f.getOptimisticResult(o);if(O.useSyncExternalStore(O.useCallback(v=>{const B=l?()=>{}:f.subscribe(ft.batchCalls(v));return f.updateResult(),B},[f,l]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),O.useEffect(()=>{f.setOptions(o,{listeners:!1})},[o,f]),At(o,R))throw Bt(o,f,u);if(Mt({result:R,errorResetBoundary:u,throwOnError:o.throwOnError,query:r.getQueryCache().get(o.queryHash)}))throw R.error;return(j=(h=r.getDefaultOptions().queries)==null?void 0:h._experimental_afterQuery)==null||j.call(h,o,R),o.notifyOnChangeProps?R:f.trackResult(R)}function Nt(s,t){return kt(s,It)}const $t=St("/")({errorComponent:()=>U.jsx("div",{children:"Error While Rendering Index Page"}),component:zt}),Wt=async()=>{const s=await xt.auth.user.$get();return s.ok?(await s.json()).data:null};function zt(){const{isPending:s,isLoading:t,data:e,error:r}=Nt({queryKey:["auth"],queryFn:Wt}),l=Et();return O.useEffect(()=>{e&&localStorage.setItem("user",JSON.stringify(e)),localStorage.getItem("user")||l({to:"/about"})},[e,l]),s?U.jsx("p",{children:"Loading..."}):t?U.jsx("p",{children:"Loading..."}):r?U.jsx("p",{children:"Error"}):U.jsx(U.Fragment,{children:e==null?void 0:e.username})}export{$t as Route,Wt as getAuth};
